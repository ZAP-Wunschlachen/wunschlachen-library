<template>
  <div class="container">
    <div class="content-wrapper">
      <div>
        <slot name="logo"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            width="120"
            height="43"
            viewBox="0 0 120 43"
            fill="none"
          >
            <path
              d="M20.3753 16.0753L18.5005 8.70333C18.2489 7.71242 17.8426 6.97337 17.2857 6.48617C16.7267 5.99897 16.0069 5.75537 15.1242 5.75537C14.2414 5.75537 13.5401 6.0031 12.9626 6.49855C12.3872 6.99401 11.9623 7.74751 11.6921 8.757L9.8173 16.0773L7.58566 6.15999H3.66895L6.2079 17.0043C6.37084 17.6896 6.64103 18.2532 7.01847 18.695C7.39591 19.1368 7.84141 19.465 8.35498 19.6818C8.86855 19.8985 9.37799 20.008 9.88124 20.008C10.6733 20.008 11.3704 19.7602 11.9747 19.2627C12.577 18.7673 13.006 18.0241 13.2576 17.0332L15.0973 9.61166L16.9577 17.0332C17.2094 18.0241 17.6322 18.7693 18.2282 19.2627C18.8223 19.7582 19.5256 20.008 20.3361 20.008C20.8394 20.008 21.3447 19.8985 21.85 19.6818C22.3533 19.4671 22.7947 19.1388 23.1742 18.695C23.5537 18.2512 23.8218 17.6896 23.9847 17.0043L26.3896 6.15999H22.5265L20.3753 16.0732V16.0753Z"
              fill="#172774"
            />
            <path
              d="M37.4361 12.3265C37.4361 12.9582 37.3413 13.5466 37.1536 14.0978C36.9659 14.6489 36.6668 15.0845 36.2626 15.4086C35.8583 15.7328 35.3489 15.8958 34.7363 15.8958C34.1237 15.8958 33.6143 15.7348 33.21 15.4086C32.8058 15.0845 32.5088 14.6469 32.319 14.0978C32.1293 13.5486 32.0365 12.9582 32.0365 12.3265V6.16016H27.8228V12.8116C27.8228 14.1267 28.0826 15.3261 28.6065 16.4078C29.1283 17.4896 29.8976 18.3545 30.9165 19.0028C31.9334 19.653 33.208 19.9771 34.7384 19.9771C36.2688 19.9771 37.5434 19.6572 38.5602 19.0172C39.577 18.3772 40.3464 17.5123 40.8702 16.4223C41.392 15.3323 41.654 14.137 41.654 12.8385V6.16016H37.4403V12.3265H37.4361Z"
              fill="#172774"
            />
            <path
              d="M55.2791 6.74461C54.2252 6.10465 52.8969 5.78467 51.2943 5.78467C49.6918 5.78467 48.3676 6.10878 47.324 6.75906C46.2804 7.40935 45.4966 8.2702 44.9727 9.34162C44.4509 10.4151 44.189 11.6186 44.189 12.9522V19.6017H48.4027V13.4374C48.4027 12.7892 48.5017 12.1946 48.6997 11.6537C48.8977 11.1129 49.2091 10.6794 49.6319 10.3552C50.0548 10.0311 50.6075 9.87011 51.2923 9.87011C51.977 9.87011 52.536 10.0311 52.967 10.3552C53.4002 10.6794 53.7137 11.1129 53.9117 11.6537C54.1097 12.1946 54.2087 12.7892 54.2087 13.4374V19.6017H58.4224V12.9233C58.4224 11.6083 58.1605 10.4089 57.6386 9.32717C57.1168 8.24543 56.3289 7.38458 55.275 6.74461H55.2791Z"
              fill="#172774"
            />
            <path
              d="M67.353 16.5319C67.091 16.631 66.7631 16.6805 66.3671 16.6805C65.7195 16.6805 65.1832 16.5649 64.7604 16.3296C64.3376 16.0943 63.9808 15.7268 63.6941 15.221L60.6147 16.9241C61.1737 17.9522 61.943 18.7222 62.9248 19.2363C63.9065 19.7503 65.1172 20.0063 66.5569 20.0063C67.6191 20.0063 68.5926 19.8164 69.4753 19.4386C70.3581 19.0608 71.0635 18.5323 71.5956 17.8572C72.1256 17.1822 72.3917 16.3936 72.3917 15.4915C72.3917 14.643 72.2164 13.9679 71.8658 13.4642C71.5151 12.9605 71.0635 12.5683 70.5148 12.2875C69.9662 12.0088 69.3804 11.7983 68.7596 11.6537C68.1388 11.5092 67.5531 11.3833 67.0044 11.2739C66.4558 11.1665 66.0041 11.0282 65.6535 10.8548C65.3028 10.6835 65.1275 10.4358 65.1275 10.1116C65.1275 9.89488 65.1853 9.71528 65.3028 9.57077C65.4204 9.42626 65.5916 9.31478 65.8164 9.23221C66.0412 9.14963 66.297 9.11041 66.5857 9.11041C67.089 9.11041 67.5613 9.22395 68.0027 9.44897C68.4441 9.67605 68.7555 10.0229 68.9349 10.4894L71.9875 8.73263C71.7358 8.22891 71.3666 7.7541 70.8799 7.31232C70.3931 6.87054 69.7909 6.50514 69.069 6.21819C68.3492 5.92918 67.485 5.78467 66.4764 5.78467C65.342 5.78467 64.3561 5.98285 63.5188 6.37921C62.6814 6.77558 62.0379 7.30819 61.5883 7.97499C61.1386 8.64179 60.9138 9.38084 60.9138 10.1922C60.9138 11.0571 61.0891 11.7466 61.4398 12.2607C61.7904 12.7747 62.24 13.1752 62.7907 13.4642C63.3393 13.7532 63.9292 13.9659 64.5603 14.1001C65.1894 14.2342 65.7793 14.3519 66.33 14.451C66.8786 14.5501 67.3303 14.6822 67.6809 14.8432C68.0316 15.0043 68.2069 15.2479 68.2069 15.572C68.2069 15.7887 68.1306 15.9786 67.9779 16.1397C67.8253 16.3007 67.617 16.4328 67.3571 16.5319H67.353Z"
              fill="#172774"
            />
            <path
              d="M78.3749 19.4237C79.2659 19.7932 80.2168 19.9687 81.2253 19.9501C82.5392 19.9316 83.7602 19.6157 84.8863 19.0026C86.0124 18.3895 86.8808 17.4171 87.4933 16.0835L84.0366 14.2173C83.7664 14.7417 83.3889 15.169 82.9022 15.5014C82.4154 15.8358 81.8585 16.0009 81.2274 16.0009C80.652 16.0009 80.1281 15.8626 79.6599 15.5819C79.1917 15.3032 78.8225 14.9192 78.5523 14.4341C78.2821 13.9469 78.1481 13.4246 78.1481 12.8651C78.1481 12.2706 78.2821 11.74 78.5523 11.2694C78.8225 10.8007 79.1917 10.4271 79.6599 10.1484C80.1281 9.8697 80.6499 9.72931 81.2274 9.72931C81.8565 9.72931 82.4154 9.89034 82.9022 10.2144C83.3889 10.5406 83.7664 10.9721 84.0366 11.513L87.4933 9.6488C86.8808 8.3152 86.0124 7.34081 84.8863 6.72769C83.7602 6.11456 82.5412 5.79871 81.2253 5.78013C80.2168 5.76155 79.2659 5.93909 78.3749 6.30861C77.4839 6.67814 76.7126 7.18598 76.0649 7.83626C75.4173 8.48448 74.9037 9.24005 74.5242 10.1071C74.1468 10.9721 73.957 11.8928 73.957 12.8651C73.957 13.8375 74.1468 14.7313 74.5242 15.5963C74.9017 16.4613 75.4152 17.2231 76.0649 17.8816C76.7126 18.5402 77.4819 19.0542 78.3749 19.4237Z"
              fill="#172774"
            />
            <path
              d="M94.1103 13.0841C94.1103 12.4359 94.2279 11.8579 94.4609 11.3542C94.694 10.8505 95.0364 10.452 95.4881 10.1651C95.9377 9.87812 96.4513 9.73362 97.0288 9.73362C97.6063 9.73362 98.1281 9.89051 98.5406 10.2064C98.9552 10.5222 99.2604 10.9268 99.4584 11.4223C99.6564 11.9177 99.7554 12.4627 99.7554 13.0573V19.5746L103.969 19.6014V12.6258C103.969 11.2035 103.734 9.98135 103.266 8.9636C102.798 7.94585 102.101 7.16138 101.172 6.61225C100.244 6.06313 99.0872 5.7865 97.7012 5.7865C96.6926 5.7865 95.7727 5.97642 94.9456 6.35421C94.6424 6.49252 94.3681 6.65561 94.1083 6.82902V0H89.8945V19.6035H94.1083V13.0883L94.1103 13.0841Z"
              fill="#172774"
            />
            <path
              d="M41.6502 22.9067H37.4365V42.1324H41.6502V22.9067Z"
              fill="#172774"
            />
            <path
              d="M54.3549 29.2217C53.2556 28.6003 52.0057 28.2886 50.6011 28.2886C49.1966 28.2886 47.9714 28.6086 46.8742 29.2485C45.7748 29.8885 44.9024 30.7452 44.2527 31.8166C43.6051 32.8901 43.2812 34.0751 43.2812 35.3715C43.2812 36.668 43.5638 37.8859 44.131 38.9677C44.6982 40.0494 45.4778 40.9103 46.4678 41.5502C47.4578 42.1902 48.6025 42.5102 49.8978 42.5102C50.9971 42.5102 51.9335 42.2769 52.707 41.8083C53.1896 41.5151 53.6 41.1477 53.9486 40.7224V42.1324H57.9189V35.3736C57.9189 34.0214 57.5992 32.8137 56.9599 31.7506C56.3205 30.6874 55.4522 29.8451 54.3528 29.2237L54.3549 29.2217ZM53.3154 36.9817C53.0534 37.4607 52.6904 37.8426 52.2223 38.1316C51.7541 38.4206 51.2137 38.5651 50.6011 38.5651C49.9886 38.5651 49.4482 38.4206 48.98 38.1316C48.5118 37.8426 48.1426 37.4607 47.8724 36.9817C47.6022 36.5049 47.4682 35.9784 47.4682 35.4004C47.4682 34.8224 47.6022 34.296 47.8724 33.8191C48.1426 33.3422 48.5118 32.9582 48.98 32.6692C49.4482 32.3823 49.9886 32.2378 50.6011 32.2378C51.2137 32.2378 51.7541 32.3823 52.2223 32.6692C52.6904 32.9582 53.0555 33.3422 53.3154 33.8191C53.5773 34.298 53.7073 34.8245 53.7073 35.4004C53.7073 35.9764 53.5773 36.5049 53.3154 36.9817Z"
              fill="#172774"
            />
            <path
              d="M64.9831 32.6816C65.4513 32.4008 65.9731 32.2625 66.5506 32.2625C67.1797 32.2625 67.7387 32.4235 68.2254 32.7477C68.7122 33.0738 69.0896 33.5053 69.3598 34.0462L72.8166 32.182C72.204 30.8484 71.3357 29.874 70.2095 29.2609C69.0834 28.6478 67.8645 28.3319 66.5486 28.3133C65.54 28.2948 64.5892 28.4723 63.6982 28.8418C62.8072 29.2113 62.0358 29.7192 61.3882 30.3695C60.7405 31.0177 60.227 31.7733 59.8475 32.6403C59.47 33.5053 59.2803 34.426 59.2803 35.3983C59.2803 36.3707 59.47 37.2645 59.8475 38.1295C60.2249 38.9945 60.7385 39.7563 61.3882 40.4148C62.0358 41.0734 62.8051 41.5874 63.6982 41.9569C64.5892 42.3264 65.54 42.5019 66.5486 42.4833C67.8624 42.4648 69.0834 42.1489 70.2095 41.5358C71.3357 40.9227 72.204 39.9503 72.8166 38.6167L69.3598 36.7505C69.0896 37.2749 68.7122 37.7022 68.2254 38.0346C67.7387 38.369 67.1818 38.5342 66.5506 38.5342C65.9752 38.5342 65.4513 38.3958 64.9831 38.1151C64.5149 37.8364 64.1457 37.4524 63.8756 36.9673C63.6054 36.4801 63.4713 35.9578 63.4713 35.3983C63.4713 34.8038 63.6054 34.2732 63.8756 33.8026C64.1457 33.3339 64.5149 32.9603 64.9831 32.6816Z"
              fill="#172774"
            />
            <path
              d="M85.46 29.2712C84.5318 28.7282 83.3748 28.4557 81.9888 28.4557C80.9802 28.4557 80.0603 28.6415 79.2332 29.0172C78.93 29.1555 78.6557 29.3145 78.3958 29.4879V22.9087H74.1821V42.1344H78.3958V35.6832C78.3958 35.0411 78.5134 34.4693 78.7465 33.9697C78.9795 33.4701 79.3219 33.0779 79.7736 32.793C80.2232 32.5081 80.7368 32.3657 81.3143 32.3657C81.8918 32.3657 82.4136 32.5226 82.8261 32.8343C83.2407 33.146 83.5459 33.5486 83.744 34.0378C83.942 34.5292 84.041 35.07 84.041 35.6563V42.1076L88.2547 42.1344V35.229C88.2547 33.819 88.0196 32.6113 87.5514 31.6019C87.0832 30.5944 86.386 29.8182 85.4579 29.2732L85.46 29.2712Z"
              fill="#172774"
            />
            <path
              d="M100.681 29.1535C99.6725 28.5218 98.4474 28.208 97.0077 28.208C95.5681 28.208 94.4007 28.528 93.3468 29.1679C92.2928 29.8079 91.4699 30.6646 90.8759 31.7361C90.2819 32.8095 89.9849 33.9945 89.9849 35.2909C89.9849 36.7154 90.3046 37.9685 90.9439 39.0481C91.5833 40.1299 92.4661 40.9722 93.5922 41.575C94.7183 42.1778 95.9827 42.4812 97.3872 42.4812C98.7918 42.4812 100.093 42.1427 101.182 41.4676C102.271 40.7926 103.105 39.8409 103.682 38.6146L100.467 36.992C100.178 37.5866 99.7591 38.051 99.2105 38.3834C98.6619 38.7178 98.0349 38.883 97.3336 38.883C96.6324 38.883 96.0507 38.7302 95.5372 38.4226C95.0236 38.1171 94.6276 37.6918 94.3492 37.151C94.2007 36.8619 94.0975 36.5461 94.0315 36.2055H103.789V35.0164C103.789 33.8087 103.523 32.6857 102.993 31.6494C102.461 30.613 101.692 29.779 100.683 29.1494L100.681 29.1535ZM94.1986 33.9388C94.3058 33.5424 94.4811 33.1873 94.7245 32.8715C94.9679 32.5556 95.2835 32.3038 95.6712 32.1138C96.059 31.926 96.4942 31.831 96.9809 31.831C97.4677 31.831 97.8946 31.9219 98.2638 32.1015C98.633 32.2811 98.9341 32.5329 99.1693 32.8591C99.4023 33.1832 99.5467 33.5445 99.6024 33.9408H94.2006L94.1986 33.9388Z"
              fill="#172774"
            />
            <path
              d="M119.001 31.8579C118.479 30.7762 117.691 29.9153 116.637 29.2754C115.583 28.6354 114.255 28.3154 112.652 28.3154C111.05 28.3154 109.726 28.6395 108.682 29.2898C107.638 29.9401 106.855 30.801 106.331 31.8724C105.809 32.9459 105.547 34.1494 105.547 35.483V42.1324H109.761V35.9681C109.761 35.3199 109.86 34.7254 110.058 34.1845C110.256 33.6436 110.567 33.2101 110.99 32.886C111.413 32.5619 111.965 32.4009 112.65 32.4009C113.335 32.4009 113.894 32.5619 114.325 32.886C114.758 33.2101 115.072 33.6436 115.27 34.1845C115.468 34.7254 115.567 35.3199 115.567 35.9681V42.1324H119.78V35.4541C119.78 34.1391 119.518 32.9397 118.997 31.8579H119.001Z"
              fill="#172774"
            />
            <path
              d="M14.9837 31.311C8.94672 31.311 3.28924 28.0719 0.220215 22.8573L3.82755 20.731C6.14789 24.6719 10.4214 27.1203 14.9837 27.1203C19.546 27.1203 23.8195 24.6719 26.1399 20.731L29.7472 22.8573C26.6782 28.0719 21.0207 31.311 14.9837 31.311Z"
              fill="#172774"
            /></svg
        ></slot>
      </div>
      <div class="input-section">
        <div class="header">
          <h2>Geben Sie Ihre E-Mail-Adresse und Ihr Passwort ein</h2>
        </div>

        <div class="input-group">
          <GenericInput
            class="w-full"
            id="email"
            placeholder="E-Mail-Adresse"
            v-model="localEmail"
            :success="emailState === 'success'"
            :error="emailState === 'error'"
            @input="updateEmail"
          />
          <GenericInput
            class="w-full"
            id="password"
            :type="passwordVisible ? 'text' : 'password'"
            placeholder="Passwort"
            v-model="localPassword"
            :success="passwordState === 'success'"
            :error="passwordState === 'error'"
            @input="updatePassword"
          >
            <template #appendIcon>
              <div @click="togglePasswordVisibility">
                <slot name="passwordIcon" :visible="passwordVisible"></slot>
              </div>
            </template>
          </GenericInput>
          <GenericCheckbox v-model="rememberUsername">
            <template #label
              ><p class="p-small">Benutzernamen speichern</p>
            </template></GenericCheckbox
          >

          <NuxtLink @click.prevent="forgotPassword">
            <div class="link-container">
              <a class="a-small">Passwort vergessen?</a>
            </div>
          </NuxtLink>
        </div>
      </div>
      <GenericButton
        :outlined="false"
        :plain="false"
        :disabled="isSubmitDisabled"
        class="submit-button"
        @click="handleSubmit"
      >
        <template #label> Weiter </template>
      </GenericButton>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, watch, computed, defineProps, defineEmits } from "vue";

interface Props {
  email: string;
  emailState: string;
  password: string;
  passwordState: string;
  rememberUsername: boolean;
}

const props = defineProps<Props>();

const emit = defineEmits<{
  (e: "update:email", value: string): void;
  (e: "update:password", value: string): void;
  (e: "validate:password"): void;
  (e: "validate:email"): void;
  (e: "forgot-password"): void;
  (e: "validate"): void;
  (e: "update:rememberUsername", value: boolean): void;
}>();

const localEmail = ref(props.email);
const localPassword = ref(props.password);
const rememberUsername = ref(props.rememberUsername);
const passwordVisible = ref(false);

const updateEmail = () => {
  emit("update:email", localEmail.value);
  emit("validate:email");
};

watch(rememberUsername, (newValue) => {
  emit("update:rememberUsername", newValue);
});

const updatePassword = () => {
  emit("update:password", localPassword.value);
  emit("validate:password");
};

const forgotPassword = () => {
  emit("forgot-password");
};

const togglePasswordVisibility = () => {
  passwordVisible.value = !passwordVisible.value;
};

watch(
  () => [props.email, props.password],
  () => {
    localEmail.value = props.email;
    localPassword.value = props.password;
  }
);

const isSubmitDisabled = computed(() => {
  return props.emailState !== "success" || props.passwordState !== "success";
});

const handleSubmit = () => {
  emit("validate");
  if (!isSubmitDisabled.value) {
    // Handle the form submission
  }
};
</script>

<style scoped>
.container {
  display: flex;
  width: 100%;
  height: 100%;
  padding-top: 144px;
  padding-bottom: 280px;
  min-width: 100%;
  align-items: center;
  justify-content: center;
  gap: 8px;
  background-color: var(--dental-light-blue-3);
}

.content-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 62px;
  max-width: 400px;
}

.input-section {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 40px;
  align-self: stretch;
}

.header {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}

.text-center {
  max-width: 300px;
  text-align: center;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 1rem; /* Equivalent to gap-4 */
  width: 100%;
}

.link-container {
  display: flex;
  align-items: flex-start;
  cursor: pointer;
}

.submit-button {
  min-width: 290px;
  margin: 10px;
}
</style>
